<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jhta.planit.buddy.mybatis.buddyMapper">
	<resultMap type="com.jhta.planit.buddy.vo.BuddyListVo" id="buddylistvo">
		<result property="mem_id" column="mem_id"/>
		<result property="buddy_indate" column="buddy_indate"/>
		<result property="buddy_outdate" column="buddy_outdate"/>
		<result property="buddy_gender" column="buddy_gender"/>
		<result property="buddy_birthyear" column="buddy_birthyear"/>
		<result property="buddy_msg" column="buddy_msg"/>
		<collection property="buddy_city" ofType="String">
			<result property="buddy_city" column="buddy_city"/>
		</collection>
	</resultMap>
	<select id="buddy_showAll" resultMap="buddylistvo">
		select  b.mem_id,TO_CHAR(b.buddy_indate, 'YYYY-MM-DD') buddy_indate,TO_CHAR(b.buddy_outdate, 'YYYY-MM-DD') buddy_outdate,b.buddy_gender,b.buddy_birthyear,b.buddy_msg,t.buddy_city
		from buddy b, buddy_country c, buddy_city t where b.buddy_num=c.buddy_num and c.country_num=t.country_num
	</select>
	
	<insert id="buddy_insert" parameterType="com.jhta.planit.buddy.vo.BuddyVo">
		insert into buddy
		values(buddy_seq.nextval,'test',#{buddy_gender},#{buddy_birthYear},#{buddy_indate},#{buddy_outdate},#{buddy_msg},0)
	</insert>
	<insert id="buddyCountry_insert" parameterType="String">
		insert into buddy_country
		values(buddycountry_seq.nextval,buddy_seq.currval,#{buddy_country})
	</insert>
	<insert id="buddyCity_insert" parameterType="String">
		insert into buddy_city
		values(buddycity_seq.nextval,buddycountry_seq.currval,#{buddy_city})
	</insert>
	

	<select id="buddy_showCountry" resultType="String">
		select distinct buddy_country from buddy_country c, buddy b where b.buddy_state=0
	</select>
	<select id="buddy_showCity" parameterType="String" resultType="com.jhta.planit.buddy.vo.BuddyCityVo">
		select distinct buddy_city from buddy b, buddy_city t, buddy_country c where c.country_num=t.country_num and b.buddy_state=0 and c.buddy_country=#{country}
	</select>
</mapper>